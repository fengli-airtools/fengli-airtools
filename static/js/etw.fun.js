var ETWobj=new Object();var ETW=new Object();ETW.$=function(id){return typeof id==="string"?document.getElementById(id):id;}
ETW.$$=function(oParent,elem){return(oParent||document).getElementsByTagName(elem);}
ETW.$$$=function(oParent,sClass){var aElem=ETW.$$(oParent,'*');var aClass=[];var i=0;for(i=0;i<aElem.length;i++)if(aElem[i].className==sClass)aClass.push(aElem[i]);return aClass;}
ETW.hasClassName=function(element,className){if(!element)return;var elementClassName=element.className;if(elementClassName.length==0)return false;if(elementClassName==className||elementClassName.match(new RegExp("(^|\\s)"+className+"(\\s|$)")))return true;return false;}
ETW.addClassName=function(element,className){if(!element)return;var elementClassName=element.className;if(elementClassName.length==0){element.className=className;return;}if(elementClassName==className||elementClassName.match(new RegExp("(^|\\s)"+className+"(\\s|$)")))return;element.className=elementClassName+" "+className;}
ETW.removeClassName=function(element,className){if(!element)return;var elementClassName=element.className;if(elementClassName.length==0)return;if(elementClassName==className){element.className="";return;}if(elementClassName.match(new RegExp("(^|\\s)"+className+"(\\s|$)")))element.className=elementClassName.replace((new RegExp("(^|\\s)"+className+"(\\s|$)"))," ");}
ETW.createele=function(ele,id,oParent){var element=document.createElement(ele);element.setAttribute("id",id);oParent.appendChild(element);}
ETW.set_screen_size=function(x,y,width,height){window.moveTo(x,y);window.resizeTo(width,height);}
ETW.openNewDiv=function(_id,msg,newWidth,newHeight,newTop,newBgcolor){var m="mask";if(document.getElementById(_id))document.body.removeChild(document.getElementById(_id));if(document.getElementById(m))document.body.removeChild(document.getElementById(m));var newA=document.createElement("a");newA.style.display='block';newA.style.width='30px';newA.style.height='20px';newA.style.color='#4D6B7E';newA.style.fontSize='14px';newA.style.fontWeight='bold';newA.href="#";newA.innerHTML="关闭";var newMask=document.createElement("div");newMask.id=m;newMask.style.position="absolute";newMask.style.zIndex="1";_scrollWidth=Math.max(document.body.scrollWidth,document.documentElement.scrollWidth);_scrollHeight=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight);newMask.style.width=_scrollWidth+"px";newMask.style.height=_scrollHeight+"px";newMask.style.top="0px";newMask.style.left="0px";newMask.style.background="#303030";newMask.style.filter="alpha(opacity=10)";newMask.style.opacity="0.30";document.body.appendChild(newMask);var newDiv=document.createElement("div");newDiv.id=_id;newDiv.style.position="absolute";newDiv.style.zIndex="9999";newDivWidth=newWidth;newDivHeight=newHeight;newDiv.style.width=parseInt(newDivWidth)+"px";newDiv.style.height=parseInt(newDivHeight)+"px";newDiv.style.top=parseInt(newTop)+"px";newDiv.style.left=(document.body.scrollLeft+document.body.clientWidth/2-newDivWidth/2)+"px";newDiv.style.background=newBgcolor;document.body.appendChild(newDiv);newDiv.appendChild(newA);newDiv.appendChild(msg);function newDivCenter(){newDiv.style.top=(document.body.scrollTop+document.body.clientHeight/2-newDivHeight/2)+"px";newDiv.style.left=(document.body.scrollLeft+document.body.clientWidth/2-newDivWidth/2)+"px";}if(document.all){window.attachEvent("onscroll",newDivCenter);}else{window.addEventListener('scroll',newDivCenter,false);}newA.onclick=function(){if(document.all){window.detachEvent("onscroll",newDivCenter);}else{window.removeEventListener('scroll',newDivCenter,false);}document.body.removeChild(docEle(_id));document.body.removeChild(docEle(m));return false;}}
ETW.openwindow=function(url,width,height){var newname=new Date().getTime();window.open(url,newname,'height='+height+', width='+width+', top=0,left=0,fullscreen=no,toolbar=no, menubar=no, scrollbars=yes, resizable=yes,location=no, status=no,fullscreen=no');}
ETW.set_iframe=function(url,width,height,showdiv){var iframe=document.createElement('iframe');iframe.setAttribute('src',url);iframe.setAttribute('width',width);iframe.setAttribute('height',height);iframe.setAttribute('frameBorder','0');ETW.$(showdiv).innerHTML='';ETW.$(showdiv).appendChild(iframe);}
ETW.open_url=function(msg,url,width,height,scrolltype){var defaultsize=this.windowSize();defaultsize=defaultsize.split(",");width=(width==''||width==undefined)?(parseInt(defaultsize[1])-30):width;height=(height==''||height==undefined)?(parseInt(defaultsize[0])-30):height;var iTop=0;var iLeft=0;var tempheight=height-20;var showscroll=scrolltype==true?'scrolling=auto':'scrolling=no';var OpenWindow=window.open("","Detail","Scrollbars=no,Toolbar=no,Location=no,Direction=no,Resizeable=no,Width="+width+" ,Height="+height+",top="+iTop+",left="+iLeft);OpenWindow.document.write("<TITLE>"+msg+"</TITLE>")
OpenWindow.document.write("<BODY BGCOLOR=#ffffff>")
OpenWindow.document.write("<iframe src='"+url+"' width=98% height='"+tempheight+"' "+showscroll+" frameborder=0></iframe>")
OpenWindow.document.write("</BODY>")
OpenWindow.document.write("</HTML>")
OpenWindow.document.close()}
ETW.createjs=function(src){var script=document.createElement("script");script.setAttribute('type','text/javascript');script.setAttribute('src',src);var header=document.getElementsByTagName('head');header[0].appendChild(script)}
ETW.gotourl=function(url){window.location=url;}
ETW.setcookie=function(name,value){var Days=30;var exp=new Date();exp.setTime(exp.getTime()+Days*24*60*60*1000);document.cookie=name+"="+escape(value)+";expires="+exp.toGMTString();}
ETW.getcookie=function(name){var arr=document.cookie.match(new RegExp("(^| )"+name+"=([^;]*)(;|$)"));if(arr!=null)return unescape(arr[2]);return null;}
ETW.delcookie=function(name){var exp=new Date();exp.setTime(exp.getTime()-1);var cval=ETW.getcookie(name);if(cval!=null)document.cookie=name+"="+cval+";expires="+exp.toGMTString();}
ETW.postcontent=function(url,string,async){var xmlhttp;function createxmlhttp(){if(window.ActiveXObject){xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");}else{xmlhttp=new XMLHttpRequest()}}createxmlhttp();if(async==null||async==undefined){async=false;}async=Boolean(async);xmlhttp.open('POST',url,async);xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4){if(xmlhttp.status==200){ETW.getstr=xmlhttp.responseText;}}}
xmlhttp.send(string)}
ETW.getcontent=function(url,async){var xmlhttp;var str;function createxmlhttp(){if(window.ActiveXObject){xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");}else{xmlhttp=new XMLHttpRequest()}}createxmlhttp();if(async==null||async==undefined){async=true;}async=Boolean(async);xmlhttp.open('GET',url,async);xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4){if(xmlhttp.status==200){str=xmlhttp.responseText;ETW.getstr=str;}}}
xmlhttp.send(null)}
ETW.post_result_to_element=function(url,string,showdiv,attribute,jsevent,async){var xmlhttp;function createxmlhttp(){if(window.ActiveXObject){xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");}else{xmlhttp=new XMLHttpRequest()}}createxmlhttp();if(async==null||async==undefined){async=true;}async=Boolean(async);xmlhttp.open('POST',url,async);xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4){if(xmlhttp.status==200){var returntxt=xmlhttp.responseText;if(attribute==''){try{document.getElementById(showdiv).innerHTML=returntxt;}catch(err){}}else{document.getElementById(showdiv).setAttribute(attribute,returntxt)}if(jsevent!=undefined){var js='';var reg=/<script id="getjs"[\S\s]*?<\/script>/igm;if(returntxt.match(reg)){var tempjs=returntxt.match(reg);tempjs=tempjs.toString();tempjs=tempjs.replace(/(<script[\S\s]*?>)|(<\/script>)/ig,'');js+=tempjs;}var script=document.createElement('script');script.setAttribute('id','addjs');script.innerHTML=eval(js);}}}}
xmlhttp.send(string)}
ETW.post_string_to_url=function(url,string,gotourl,altMsg,async){var xmlhttp;function createxmlhttp(){if(window.ActiveXObject){xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");}else{xmlhttp=new XMLHttpRequest()}}createxmlhttp();if(async==null||async==undefined){async=true;}async=Boolean(async);xmlhttp.open('POST',url,async);xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4){if(xmlhttp.status==200){if(altMsg!=''){alert(altMsg);}window.location.href=gotourl;}}}
xmlhttp.send(string)}
ETW.createIframe=function(oParentId,iframeID,src,width,height){var ob=ETW.$(oParentId);ob.innerHTML='';var IFRAME=document.createElement('iframe');IFRAME.setAttribute('src',src);IFRAME.setAttribute('id',iframeID);IFRAME.setAttribute('width',width);IFRAME.setAttribute('frameBorder',"0");IFRAME.setAttribute('scrolling','no');IFRAME.setAttribute('height',height);ob.appendChild(IFRAME);}
ETW.setIframeToHtml=function(url,oParentId,width,height){var ob=ETW.$(oParentId);ob.innerHTML="";createIframe(oParentId,"",url,width,height);}
ETW.set_display=function(oParentId,show){var ob=ETW.$(oParentId);if(show==1){ob.style.cssText='display:normal;';}else{ob.style.cssText='display:none;';}}
ETW.Alert=function(width,height,moveX,moveY,msg){var closeImg='./images/closebox.png';var screenw=document.body.clientWidth;var screenh=window.screen.height;width=parseInt(width)>parseInt(screenw)?screenw:width;height=parseInt(height)>parseInt(screenh)?screenh:height;var xpos=(parseInt(screenw)-parseInt(width))/2;var ypos=(parseInt(screenh)-parseInt(height))/2;var div=document.createElement('div');div.setAttribute("id","openNewWindow");div.style.cssText='position:absolute; left:'+(parseInt(xpos)+parseInt(moveX))+'px;top:'+(parseInt(ypos)+parseInt(moveY))+'px;z-index:999; width:'+width+'px; height:'+height+'px;border:1px solid #ccc; background:#fff; box-shadow:3px 3px 3px #ccc; -moz-box-shadow:3px 3px 3px #ccc; -webkit-box-shadow:3px 3px 3px #ccc; padding:3px 20px;overflow:hidden;border:1px solid #ccc; background:#fff; box-shadow:3px 3px 3px #ccc; -moz-box-shadow:3px 3px 3px #ccc; -webkit-box-shadow:3px 3px 3px #ccc; padding:3px 20px;overflow:auto;';div.innerHTML='<div class="show_html_close"><a class="html_close_bt" href="#" onclick=\'ETW.closedivbox("openNewWindow");return false;\'><img border="0" src="'+closeImg+'" /></a></div><div class="show_html_content">'+msg+'</div>';document.body.appendChild(div);}
ETW.setHtml=function(div,html){ETW.$(div).innerHTML=html;}
ETW.closedivbox=function(oParentId){var ob=ETW.$(oParentId);ob.parentNode.removeChild(ob);}
ETW.setobjdisplay=function(div,style){ETW.$(div).style.cssText=style;}
ETW.setStyleById=function(div,style){ETW.setobjdisplay(div,style);}
ETW.setStyleByClass=function(parDiv,cClass,style){var parent=ETW.$(parDiv);var divs=ETW.$$$(parent,cClass);for(var i=0;i<divs.length;i++){divs[i].style.cssText=style;}}
ETW.encode=function(str){return encodeURIComponent(str);}
ETW.decode=function(str){return decodeURIComponent(str);}
ETW.cearHtmlByTime=function(div,timeout){if(!ETW.$(div))return;var start;function clearhtml(){ETW.$(div).innerHTML='';ETW.cearHtmlByTime(div,timeout);}function clearevent(){if(ETW.$(div).innerHTML!=''){window.setTimeout(clearhtml,timeout);window.clearInterval(start);}}start=window.setInterval(clearevent,500);}
ETW.show=function(div){if(ETW.$(div)!=null||ETW.$(div)!=undefined){ETW.$(div).style.cssText='display:block;';}}
ETW.hidden=function(div){if(ETW.$(div)!=null||ETW.$(div)!=undefined){ETW.$(div).style.cssText='display:none;';}}
ETW.in_array=function(needle,array,bool){if(typeof needle=="string"||typeof needle=="number"){var len=array.length;for(var i=0;i<len;i++){if(needle==array[i]){if(bool){return i;}return true;}}return false;}}
ETW.array_remove=function(needle,haystack){var index=-1;for(var i=0;i<haystack.length;i++){if(haystack[i]==needle){index=i;}}if(index>-1){return haystack.splice(index,1);}return false;}
ETW.thisVal=function(obj){if(obj!=null||obj!=undefined){return ETW.encode(obj.value);}}
ETW.thisLabel=function(obj){if(obj!=null||obj!=undefined){var index=obj.selectedIndex;var text=obj.options[index].text;return text;}}
ETW.getSelectVal=function(div){if(ETW.$(div)!=null||ETW.$(div)!=undefined){return ETW.encode(ETW.$(div).value);}}
ETW.getSelectLabel=function(div){if(ETW.$(div)!=null||ETW.$(div)!=undefined){var obj=ETW.$(div);var index=obj.selectedIndex;var text=obj.options[index].text;return text;}}
ETW.windowSize=function(){var winWidth=0;var winHeight=0;if(window.innerWidth)winWidth=window.innerWidth;else if((document.body)&&(document.body.clientWidth))winWidth=document.body.clientWidth;if(window.innerHeight)winHeight=window.innerHeight;else if((document.body)&&(document.body.clientHeight))winHeight=document.body.clientHeight;if(document.documentElement&&document.documentElement.clientHeight&&document.documentElement.clientWidth){winHeight=document.documentElement.clientHeight;winWidth=document.documentElement.clientWidth;}var size=winHeight+','+winWidth;return size;}
ETW.windowSizebyTtype=function(type){var winWidth=0;var winHeight=0;if(window.innerWidth)winWidth=window.innerWidth;else if((document.body)&&(document.body.clientWidth))winWidth=document.body.clientWidth;if(window.innerHeight)winHeight=window.innerHeight;else if((document.body)&&(document.body.clientHeight))winHeight=document.body.clientHeight;if(document.documentElement&&document.documentElement.clientHeight&&document.documentElement.clientWidth){winHeight=document.documentElement.clientHeight;winWidth=document.documentElement.clientWidth;}var getsize=type=="w"?winWidth:winHeight;return getsize;}
ETW.loadTips=function(divid,className,oParent,style,newTop,newLeft){ETW.delDIV(divid);var newDiv=document.createElement("div");newDiv.id=divid;newDiv.className=className;newDiv.style=style;newDiv.style.position="absolute";newDiv.style.zIndex="99999";newTop=newTop!=null?parseInt(newTop):parseInt(ETW.windowSizebyTtype('h'))/2;newDiv.style.top=newTop+"px";newLeft=newLeft!=null?parseInt(newLeft):(document.body.scrollLeft+document.body.clientWidth/2);newDiv.style.left=newLeft+"px";if(oParent==null||oParent==undefined){document.body.appendChild(newDiv);}else{oParent.appendChild(newDiv);}}
ETW.delDIV=function(divid){if(document.getElementById(divid))document.body.removeChild(document.getElementById(divid));}
ETW.nocoppy=function(pardiv,obj){ETW.$(pardiv).setAttribute("unselectable","on");ETW.$(pardiv).style.cssText="-moz-user-select:none;";var obj=ETW.$(obj)
obj.oncontextmenu=function(){return false;}
obj.onselectstart=function(){return false;}
obj.ondragstart=function(){return false;}
obj.oncopy=function(){document.selection.empty();}
obj.onbeforecopy=function(){return false;}
obj.onselect=function(){document.selection.empty()}}